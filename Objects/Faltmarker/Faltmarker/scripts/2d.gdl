!!! HOTSPOTS------------------------------------------------------------- !unID = 0HOTSPOT2 0, 0, 		unID 			: unID = unID+1HOTSPOT2 0, B, 		unID, A, 1		: unID = unID+1HOTSPOT2 A, B, 		unID, A, 2		: unID = unID+1HOTSPOT2 -1, B, 	unID, A, 3		: unID = unID+1HOTSPOT2 A, 0, 		unID, B, 1		: unID = unID+1HOTSPOT2 A, B, 		unID, B, 2		: unID = unID+1HOTSPOT2 -A, -1, 	unID, B, 3		: unID = unID+1!!! MAIN----------------------------------------------------------------- !DIM ptx[]nm     = n_margin / 1000marlen = n_marker / 1000! Grösse DeckblattIF NOT(endformat) THEN 						! ohne Lochrand	n_csize = 0.21ELSE	IF (ABS(A - 0.594)< eps) THEN 			! A2 size		n_csize = 0.192	ELSE		n_csize = 0.19	ENDIFENDIF! Array befüllenIF (A <= 0.594) THEN 						! Größe < A2	pt = (A - n_csize - n_punch_margin)/2	ptx[1] = pt + n_punch_margin	ptx[2] = ptELSE	ptx[1] = 0.21						! grundsätzlich ist das Endblatt 21cm breit	IF (ABS(A - 0.594)< eps) THEN 		! A2 Größe		ptx[2] = 0.192	ELSE		xarea = A - n_csize - ptx[1]			! Größe ohne End- u Deckblatt		xcounter = INT(xarea/0.19)				! Anzahl volle Unterteilungen		IF xcounter MOD 2 = 0 THEN 				! xcounter muss ungerade sein			xcounter = xcounter - 1		ENDIF		IF xcounter > 0 THEN 					! wenn mehr als eine volle Unterteilung			FOR i = 1 TO xcounter 				ptx[i+folding] = 0.19 			! Startpunkt entweder 2 (rechts) oder 4			NEXT i			xrest = xarea - (xcounter * 0.19)	! Restfläche berechnen		ELSE			xrest = xarea		ENDIF						pt = xrest / 2							! Restfläche durch 2 teilen		IF folding = 1 THEN 					! Restfläche rechts			ptx_dim = VARDIM1(ptx)			arrpt_1 = ptx_dim+1			arrpt_2 = ptx_dim+2		ELSE 									! Restfläche links			arrpt_1 = 2			arrpt_2 = 3		ENDIF		ptx[arrpt_1] = pt		ptx[arrpt_2] = pt	ENDIFENDIF!!! --------------------------------------------------------------------- !!!! --------------------------------------------------------------------- !!!! --------------------------------------------------------------------- !!!! Falt Marker Rand ---------------------------------------------------- !IF b_marker THEN	DRAWINDEX 	40	PEN 		pen_marker	LINE_TYPE 	line_marker	endX = 0	endY = marlen	FOR j = 1 TO VARDIM1(ptx)	! horizontal		ADD2 ptx[j], 0		ADD2 0, nm 				! Druckrand		GOSUB "sline"			! unten		DEL 1		ADD2 0, B - nm		ROT2 180		GOSUB "sline" 			! oben		DEL 2	NEXT j	Del top	FOR i = 1 TO hcounter 		! vertikal		ADD2 0, 0.297		ROT2 -90		ADD2 0, nm		GOSUB "sline"		DEL 1		ADD2 0, A - nm		ROT2 180		GOSUB "sline"		DEL 3	NEXT i	Del topENDIF!!! Falt Marker Mitte --------------------------------------------------- !IF b_mid THEN	DRAWINDEX 	50	PEN 		pen_mid	LINE_TYPE 	line_mid	length_cross = (n_mid/1000)/2						! Maße in mm	FOR i = 1 TO hcounter		ADD2 0, 0.297		FOR j = 1 TO VARDIM1(ptx)			ADD2 ptx[j], 0			GOSUB "xline"		NEXT j		DEL j-1	NEXT i	Del topENDIF!!! Marker Diagonale --------------------------------------------------- !IF b_diagonal THEN	DRAWINDEX 	40	PEN 		pen_diagonal	LINE_TYPE 	line_diagonal	angle = ATN((B-0.297)/0.105) 					! ArcTan für Winkel	rotangle = angle + 90	hypotenuse = nm / SIN(angle) 					! Abstand gemäß Druckrand	ADD2 0.105, B	ROT2 rotangle	IF b_margin THEN		ADD2 0, hypotenuse	ENDIF	endX = 0	endY = marlen	GOSUB "sline"	DEL topENDIF!!! Unterteilung --------------------------------------------------------- !IF b_division THEN	DRAWINDEX 	10	PEN 		pen_division	LINE_TYPE 	line_division !--HORIZONTAL--!	GOSUB "hline" 		! unterste Linie	ADD2 0, B 				GOSUB "hline"		! oberste Linie	DEL Top	FOR i = 1 TO hcounter 		ADD2 0, 0.297		GOSUB "hline"	NEXT i	DEL Top !--VERTIKAL--!	GOSUB "vline" 		! linke Linie	ADD2 A, 0 				GOSUB "vline"		! rechte Linie	DEL Top	FOR i = 1 TO VARDIM1(ptx) 		ADD2 ptx[i], 0		GOSUB "vline"	NEXT i	DEL Top !--DIAGONAL--!	IF b_diagonal THEN		LINE2 		0.105, B, 	0, 0.297		HOTLINE2 	0.105, B, 	0, 0.297	ENDIFENDIF!!! Lochrand ----------------------------------------------------------- !IF endformat THEN	IF b_punch_marker THEN		GOSUB "punch_marker"	ENDIF	IF b_punch_margin THEN		GOSUB "punch_margin"	ENDIFENDIF!!! Deckblatt ---------------------------------------------------------- !IF b_header THEN	FILL fill_header	POLY2_B 5, 2,					 ! 5 points, visible fill, no edges			pen_header, back_header,				A, 0, 				0,				A-n_csize, 0, 		0,				A-n_csize, 0.297, 	0,				A, 0.297, 			0,				A, 0, 				-1ENDIF!!! Schnittmarken ------------------------------------------------------ !IF b_cropmark THEN		DRAWINDEX 	50	PEN 		pen_cropmark	LINE_TYPE 	line_cropmark	length_cross = (n_cropmark/1000)/2						! Maße in mm	GOSUB "xline"	ADD2 0, B	GOSUB "xline"	ADD2 A, 0	GOSUB "xline"	ADD2 0, -B	GOSUB "xline"	DEL topENDIFEND! ---------------------------------------------------------------------- !! ---------------------------------------------------------------------- !! ---------------------------------------------------------------------- !! ---------------------------------------------------------------------- !! ---------------------------------------------------------------------- !!!! LINEWORK ----------------------------------------------------------- !"hline":	LINE2 		0, 0, 	A, 0	HOTLINE2 	0, 0, 	A, 0RETURN"vline":	LINE2 		0, 0, 	0, B	HOTLINE2 	0, 0, 	0, BRETURN"xline":	LINE2 		0, -length_cross, 	0, length_cross	HOTLINE2 	0, -length_cross, 	0, length_cross	ROT2 -90	LINE2 		0, -length_cross, 	0, length_cross	HOTLINE2 	0, -length_cross, 	0, length_cross	Del 1RETURN"punch_marker":	PEN 		pen_punch_margin	LINE_TYPE 	line_marker	LINE2 		0, 0.1485, 	0.006, 0.1485	HOTLINE2 	0, 0.1485, 	0.006, 0.1485	CIRCLE2 	0.012, 0.1885, 0.0015	CIRCLE2 	0.012, 0.1085, 0.0015RETURN"punch_margin":	PEN 		pen_punch_margin	LINE_TYPE 	line_punch_margin	ADD2 n_punch_margin, 0	endX = 0	endY = 0.297	GOSUB "sline"	DEL topRETURN"sline":	LINE2 		0, 0, 	endX, endY	HOTLINE2 	0, 0, 	endX, endYRETURN	